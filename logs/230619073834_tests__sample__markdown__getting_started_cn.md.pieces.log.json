[
  {
    "text": "# Quickstart Guide\n",
    "type": "text",
    "translate": true,
    "length": 19,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "This tutorial gives you a quick walkthrough about building an end-to-end language model application with LangChain.\n",
    "type": "text",
    "translate": true,
    "length": 116,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Installation\n",
    "type": "text",
    "translate": true,
    "length": 16,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "To get started, install LangChain with the following command:\n",
    "type": "text",
    "translate": true,
    "length": 62,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```bash\n",
    "type": "code",
    "translate": false,
    "length": 8,
    "metadata": {}
  },
  {
    "text": "pip install langchain\n",
    "type": "code",
    "translate": false,
    "length": 22,
    "metadata": {}
  },
  {
    "text": "# or\n",
    "type": "code",
    "translate": false,
    "length": 5,
    "metadata": {}
  },
  {
    "text": "conda install langchain -c conda-forge\n",
    "type": "code",
    "translate": false,
    "length": 39,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Environment Setup\n",
    "type": "text",
    "translate": true,
    "length": 21,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Using LangChain will usually require integrations with one or more model providers, data stores, apis, etc.\n",
    "type": "text",
    "translate": true,
    "length": 108,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "For this example, we will be using OpenAI's APIs, so we will first need to install their SDK:\n",
    "type": "text",
    "translate": true,
    "length": 94,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```bash\n",
    "type": "code",
    "translate": false,
    "length": 8,
    "metadata": {}
  },
  {
    "text": "pip install openai\n",
    "type": "code",
    "translate": false,
    "length": 19,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "We will then need to set the environment variable in the terminal.\n",
    "type": "text",
    "translate": true,
    "length": 67,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```bash\n",
    "type": "code",
    "translate": false,
    "length": 8,
    "metadata": {}
  },
  {
    "text": "export OPENAI_API_KEY=\"...\"\n",
    "type": "code",
    "translate": false,
    "length": 28,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Alternatively, you could do this from inside the Jupyter notebook (or Python script):\n",
    "type": "text",
    "translate": true,
    "length": 86,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "import os\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "os.environ[\"OPENAI_API_KEY\"] = \"...\"\n",
    "type": "code",
    "translate": false,
    "length": 37,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Building a Language Model Application: LLMs\n",
    "type": "text",
    "translate": true,
    "length": 47,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Now that we have installed LangChain and set up our environment, we can start building our language model application.\n",
    "type": "text",
    "translate": true,
    "length": 119,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "LangChain provides many modules that can be used to build language model applications. Modules can be combined to create more complex applications, or be used individually for simple applications.\n",
    "type": "text",
    "translate": true,
    "length": 197,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## LLMs: Get predictions from a language model\n",
    "type": "text",
    "translate": true,
    "length": 47,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "The most basic building block of LangChain is calling an LLM on some input.\n",
    "type": "text",
    "translate": true,
    "length": 76,
    "metadata": {}
  },
  {
    "text": "Let's walk through a simple example of how to do this. \n",
    "type": "text",
    "translate": true,
    "length": 56,
    "metadata": {}
  },
  {
    "text": "For this purpose, let's pretend we are building a service that generates a company name based on what the company makes.\n",
    "type": "text",
    "translate": true,
    "length": 121,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "In order to do this, we first need to import the LLM wrapper.\n",
    "type": "text",
    "translate": true,
    "length": 62,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.llms import OpenAI\n",
    "type": "code",
    "translate": false,
    "length": 34,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "We can then initialize the wrapper with any arguments.\n",
    "type": "text",
    "translate": true,
    "length": 55,
    "metadata": {}
  },
  {
    "text": "In this example, we probably want the outputs to be MORE random, so we'll initialize it with a HIGH temperature.\n",
    "type": "text",
    "translate": true,
    "length": 113,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "llm = OpenAI(temperature=0.9)\n",
    "type": "code",
    "translate": false,
    "length": 30,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "We can now call it on some input!\n",
    "type": "text",
    "translate": true,
    "length": 34,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "text = \"What would be a good company name for a company that makes colorful socks?\"\n",
    "type": "code",
    "translate": false,
    "length": 84,
    "metadata": {}
  },
  {
    "text": "print(llm(text))\n",
    "type": "code",
    "translate": false,
    "length": 17,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```pycon\n",
    "type": "code",
    "translate": false,
    "length": 9,
    "metadata": {}
  },
  {
    "text": "Feetful of Fun\n",
    "type": "code",
    "translate": false,
    "length": 15,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "For more details on how to use LLMs within LangChain, see the [LLM getting started guide](../modules/models/llms/getting_started.ipynb).\n",
    "type": "text",
    "translate": true,
    "length": 137,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Prompt Templates: Manage prompts for LLMs\n",
    "type": "text",
    "translate": true,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Calling an LLM is a great first step, but it's just the beginning.\n",
    "type": "text",
    "translate": true,
    "length": 67,
    "metadata": {}
  },
  {
    "text": "Normally when you use an LLM in an application, you are not sending user input directly to the LLM.\n",
    "type": "text",
    "translate": true,
    "length": 100,
    "metadata": {}
  },
  {
    "text": "Instead, you are probably taking user input and constructing a prompt, and then sending that to the LLM.\n",
    "type": "text",
    "translate": true,
    "length": 105,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "For example, in the previous example, the text we passed in was hardcoded to ask for a name for a company that made colorful socks.\n",
    "type": "text",
    "translate": true,
    "length": 132,
    "metadata": {}
  },
  {
    "text": "In this imaginary service, what we would want to do is take only the user input describing what the company does, and then format the prompt with that information.\n",
    "type": "text",
    "translate": true,
    "length": 164,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "This is easy to do with LangChain!\n",
    "type": "text",
    "translate": true,
    "length": 35,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "First lets define the prompt template:\n",
    "type": "text",
    "translate": true,
    "length": 39,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.prompts import PromptTemplate\n",
    "type": "code",
    "translate": false,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "prompt = PromptTemplate(\n",
    "type": "code",
    "translate": false,
    "length": 25,
    "metadata": {}
  },
  {
    "text": "    input_variables=[\"product\"],\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "    template=\"What is a good name for a company that makes {product}?\",\n",
    "type": "code",
    "translate": false,
    "length": 72,
    "metadata": {}
  },
  {
    "text": ")\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Let's now see how this works! We can call the `.format` method to format it.\n",
    "type": "text",
    "translate": true,
    "length": 77,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "print(prompt.format(product=\"colorful socks\"))\n",
    "type": "code",
    "translate": false,
    "length": 47,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```pycon\n",
    "type": "code",
    "translate": false,
    "length": 9,
    "metadata": {}
  },
  {
    "text": "What is a good name for a company that makes colorful socks?\n",
    "type": "code",
    "translate": false,
    "length": 61,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "[For more details, check out the getting started guide for prompts.](../modules/prompts/chat_prompt_template.ipynb)\n",
    "type": "text",
    "translate": true,
    "length": 116,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Chains: Combine LLMs and prompts in multi-step workflows\n",
    "type": "text",
    "translate": true,
    "length": 60,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Up until now, we've worked with the PromptTemplate and LLM primitives by themselves. But of course, a real application is not just one primitive, but rather a combination of them.\n",
    "type": "text",
    "translate": true,
    "length": 180,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "A chain in LangChain is made up of links, which can be either primitives like LLMs or other chains.\n",
    "type": "text",
    "translate": true,
    "length": 100,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "The most core type of chain is an LLMChain, which consists of a PromptTemplate and an LLM.\n",
    "type": "text",
    "translate": true,
    "length": 91,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Extending the previous example, we can construct an LLMChain which takes user input, formats it with a PromptTemplate, and then passes the formatted response to an LLM.\n",
    "type": "text",
    "translate": true,
    "length": 169,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.prompts import PromptTemplate\n",
    "type": "code",
    "translate": false,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "from langchain.llms import OpenAI\n",
    "type": "code",
    "translate": false,
    "length": 34,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "llm = OpenAI(temperature=0.9)\n",
    "type": "code",
    "translate": false,
    "length": 30,
    "metadata": {}
  },
  {
    "text": "prompt = PromptTemplate(\n",
    "type": "code",
    "translate": false,
    "length": 25,
    "metadata": {}
  },
  {
    "text": "    input_variables=[\"product\"],\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "    template=\"What is a good name for a company that makes {product}?\",\n",
    "type": "code",
    "translate": false,
    "length": 72,
    "metadata": {}
  },
  {
    "text": ")\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "We can now create a very simple chain that will take user input, format the prompt with it, and then send it to the LLM:\n",
    "type": "text",
    "translate": true,
    "length": 121,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.chains import LLMChain\n",
    "type": "code",
    "translate": false,
    "length": 38,
    "metadata": {}
  },
  {
    "text": "chain = LLMChain(llm=llm, prompt=prompt)\n",
    "type": "code",
    "translate": false,
    "length": 41,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Now we can run that chain only specifying the product!\n",
    "type": "text",
    "translate": true,
    "length": 55,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "chain.run(\"colorful socks\")\n",
    "type": "code",
    "translate": false,
    "length": 28,
    "metadata": {}
  },
  {
    "text": "# -> '\\n\\nSocktastic!'\n",
    "type": "code",
    "translate": false,
    "length": 23,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "There we go! There's the first chain - an LLM Chain.\n",
    "type": "text",
    "translate": true,
    "length": 53,
    "metadata": {}
  },
  {
    "text": "This is one of the simpler types of chains, but understanding how it works will set you up well for working with more complex chains.\n",
    "type": "text",
    "translate": true,
    "length": 134,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "[For more details, check out the getting started guide for chains.](../modules/chains/getting_started.ipynb)\n",
    "type": "text",
    "translate": true,
    "length": 109,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Agents: Dynamically Call Chains Based on User Input\n",
    "type": "text",
    "translate": true,
    "length": 55,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "So far the chains we've looked at run in a predetermined order.\n",
    "type": "text",
    "translate": true,
    "length": 64,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Agents no longer do: they use an LLM to determine which actions to take and in what order. An action can either be using a tool and observing its output, or returning to the user.\n",
    "type": "text",
    "translate": true,
    "length": 180,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "When used correctly agents can be extremely powerful. In this tutorial, we show you how to easily use agents through the simplest, highest level API.\n",
    "type": "text",
    "translate": true,
    "length": 150,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "In order to load agents, you should understand the following concepts:\n",
    "type": "text",
    "translate": true,
    "length": 71,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "- Tool: A function that performs a specific duty. This can be things like: Google Search, Database lookup, Python REPL, other chains. The interface for a tool is currently a function that is expected to have a string as an input, with a string as an output.\n",
    "type": "text",
    "translate": true,
    "length": 258,
    "metadata": {}
  },
  {
    "text": "- LLM: The language model powering the agent.\n",
    "type": "text",
    "translate": true,
    "length": 46,
    "metadata": {}
  },
  {
    "text": "- Agent: The agent to use. This should be a string that references a support agent class. Because this notebook focuses on the simplest, highest level API, this only covers using the standard supported agents. If you want to implement a custom agent, see the documentation for custom agents (coming soon).\n",
    "type": "text",
    "translate": true,
    "length": 306,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "**Agents**: For a list of supported agents and their specifications, see [here](../modules/agents/agents.md).\n",
    "type": "text",
    "translate": true,
    "length": 110,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "**Tools**: For a list of predefined tools and their specifications, see [here](../modules/agents/tools.md).\n",
    "type": "text",
    "translate": true,
    "length": 108,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "For this example, you will also need to install the SerpAPI Python package.\n",
    "type": "text",
    "translate": true,
    "length": 76,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```bash\n",
    "type": "code",
    "translate": false,
    "length": 8,
    "metadata": {}
  },
  {
    "text": "pip install google-search-results\n",
    "type": "code",
    "translate": false,
    "length": 34,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "And set the appropriate environment variables.\n",
    "type": "text",
    "translate": true,
    "length": 47,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "import os\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "os.environ[\"SERPAPI_API_KEY\"] = \"...\"\n",
    "type": "code",
    "translate": false,
    "length": 38,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Now we can get started!\n",
    "type": "text",
    "translate": true,
    "length": 24,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.agents import load_tools\n",
    "type": "code",
    "translate": false,
    "length": 40,
    "metadata": {}
  },
  {
    "text": "from langchain.agents import initialize_agent\n",
    "type": "code",
    "translate": false,
    "length": 46,
    "metadata": {}
  },
  {
    "text": "from langchain.agents import AgentType\n",
    "type": "code",
    "translate": false,
    "length": 39,
    "metadata": {}
  },
  {
    "text": "from langchain.llms import OpenAI\n",
    "type": "code",
    "translate": false,
    "length": 34,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# First, let's load the language model we're going to use to control the agent.\n",
    "type": "code",
    "translate": false,
    "length": 80,
    "metadata": {}
  },
  {
    "text": "llm = OpenAI(temperature=0)\n",
    "type": "code",
    "translate": false,
    "length": 28,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# Next, let's load some tools to use. Note that the `llm-math` tool uses an LLM, so we need to pass that in.\n",
    "type": "code",
    "translate": false,
    "length": 109,
    "metadata": {}
  },
  {
    "text": "tools = load_tools([\"serpapi\", \"llm-math\"], llm=llm)\n",
    "type": "code",
    "translate": false,
    "length": 53,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# Finally, let's initialize an agent with the tools, the language model, and the type of agent we want to use.\n",
    "type": "code",
    "translate": false,
    "length": 111,
    "metadata": {}
  },
  {
    "text": "agent = initialize_agent(tools, llm, agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION, verbose=True)\n",
    "type": "code",
    "translate": false,
    "length": 96,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# Now let's test it out!\n",
    "type": "code",
    "translate": false,
    "length": 25,
    "metadata": {}
  },
  {
    "text": "agent.run(\"What was the high temperature in SF yesterday in Fahrenheit? What is that number raised to the .023 power?\")\n",
    "type": "code",
    "translate": false,
    "length": 120,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```pycon\n",
    "type": "code",
    "translate": false,
    "length": 9,
    "metadata": {}
  },
  {
    "text": "> Entering new AgentExecutor chain...\n",
    "type": "code",
    "translate": false,
    "length": 38,
    "metadata": {}
  },
  {
    "text": " I need to find the temperature first, then use the calculator to raise it to the .023 power.\n",
    "type": "code",
    "translate": false,
    "length": 94,
    "metadata": {}
  },
  {
    "text": "Action: Search\n",
    "type": "code",
    "translate": false,
    "length": 15,
    "metadata": {}
  },
  {
    "text": "Action Input: \"High temperature in SF yesterday\"\n",
    "type": "code",
    "translate": false,
    "length": 49,
    "metadata": {}
  },
  {
    "text": "Observation: San Francisco Temperature Yesterday. Maximum temperature yesterday: 57 \u00b0F (at 1:56 pm) Minimum temperature yesterday: 49 \u00b0F (at 1:56 am) Average temperature ...\n",
    "type": "code",
    "translate": false,
    "length": 174,
    "metadata": {}
  },
  {
    "text": "Thought: I now have the temperature, so I can use the calculator to raise it to the .023 power.\n",
    "type": "code",
    "translate": false,
    "length": 96,
    "metadata": {}
  },
  {
    "text": "Action: Calculator\n",
    "type": "code",
    "translate": false,
    "length": 19,
    "metadata": {}
  },
  {
    "text": "Action Input: 57^.023\n",
    "type": "code",
    "translate": false,
    "length": 22,
    "metadata": {}
  },
  {
    "text": "Observation: Answer: 1.0974509573251117\n",
    "type": "code",
    "translate": false,
    "length": 40,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Thought: I now know the final answer\n",
    "type": "code",
    "translate": false,
    "length": 37,
    "metadata": {}
  },
  {
    "text": "Final Answer: The high temperature in SF yesterday in Fahrenheit raised to the .023 power is 1.0974509573251117.\n",
    "type": "code",
    "translate": false,
    "length": 113,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "> Finished chain.\n",
    "type": "code",
    "translate": false,
    "length": 18,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Memory: Add State to Chains and Agents\n",
    "type": "text",
    "translate": true,
    "length": 42,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "So far, all the chains and agents we've gone through have been stateless. But often, you may want a chain or agent to have some concept of \"memory\" so that it may remember information about its previous interactions. The clearest and simple example of this is when designing a chatbot - you want it to remember previous messages so it can use context from that to have a better conversation. This would be a type of \"short-term memory\". On the more complex side, you could imagine a chain/agent remembering key pieces of information over time - this would be a form of \"long-term memory\". For more concrete ideas on the latter, see this [awesome paper](https://memprompt.com/).\n",
    "type": "text",
    "translate": true,
    "length": 678,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "LangChain provides several specially created chains just for this purpose. This notebook walks through using one of those chains (the `ConversationChain`) with two different types of memory.\n",
    "type": "text",
    "translate": true,
    "length": 191,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "By default, the `ConversationChain` has a simple type of memory that remembers all previous inputs/outputs and adds them to the context that is passed. Let's take a look at using this chain (setting `verbose=True` so we can see the prompt).\n",
    "type": "text",
    "translate": true,
    "length": 241,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain import OpenAI, ConversationChain\n",
    "type": "code",
    "translate": false,
    "length": 48,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "llm = OpenAI(temperature=0)\n",
    "type": "code",
    "translate": false,
    "length": 28,
    "metadata": {}
  },
  {
    "text": "conversation = ConversationChain(llm=llm, verbose=True)\n",
    "type": "code",
    "translate": false,
    "length": 56,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "output = conversation.predict(input=\"Hi there!\")\n",
    "type": "code",
    "translate": false,
    "length": 49,
    "metadata": {}
  },
  {
    "text": "print(output)\n",
    "type": "code",
    "translate": false,
    "length": 14,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```pycon\n",
    "type": "code",
    "translate": false,
    "length": 9,
    "metadata": {}
  },
  {
    "text": "> Entering new chain...\n",
    "type": "code",
    "translate": false,
    "length": 24,
    "metadata": {}
  },
  {
    "text": "Prompt after formatting:\n",
    "type": "code",
    "translate": false,
    "length": 25,
    "metadata": {}
  },
  {
    "text": "The following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.\n",
    "type": "code",
    "translate": false,
    "length": 231,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Current conversation:\n",
    "type": "code",
    "translate": false,
    "length": 22,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Human: Hi there!\n",
    "type": "code",
    "translate": false,
    "length": 17,
    "metadata": {}
  },
  {
    "text": "AI:\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "> Finished chain.\n",
    "type": "code",
    "translate": false,
    "length": 18,
    "metadata": {}
  },
  {
    "text": "' Hello! How are you today?'\n",
    "type": "code",
    "translate": false,
    "length": 29,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "output = conversation.predict(input=\"I'm doing well! Just having a conversation with an AI.\")\n",
    "type": "code",
    "translate": false,
    "length": 94,
    "metadata": {}
  },
  {
    "text": "print(output)\n",
    "type": "code",
    "translate": false,
    "length": 14,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```pycon\n",
    "type": "code",
    "translate": false,
    "length": 9,
    "metadata": {}
  },
  {
    "text": "> Entering new chain...\n",
    "type": "code",
    "translate": false,
    "length": 24,
    "metadata": {}
  },
  {
    "text": "Prompt after formatting:\n",
    "type": "code",
    "translate": false,
    "length": 25,
    "metadata": {}
  },
  {
    "text": "The following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.\n",
    "type": "code",
    "translate": false,
    "length": 231,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Current conversation:\n",
    "type": "code",
    "translate": false,
    "length": 22,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Human: Hi there!\n",
    "type": "code",
    "translate": false,
    "length": 17,
    "metadata": {}
  },
  {
    "text": "AI:  Hello! How are you today?\n",
    "type": "code",
    "translate": false,
    "length": 31,
    "metadata": {}
  },
  {
    "text": "Human: I'm doing well! Just having a conversation with an AI.\n",
    "type": "code",
    "translate": false,
    "length": 62,
    "metadata": {}
  },
  {
    "text": "AI:\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "> Finished chain.\n",
    "type": "code",
    "translate": false,
    "length": 18,
    "metadata": {}
  },
  {
    "text": "\" That's great! What would you like to talk about?\"\n",
    "type": "code",
    "translate": false,
    "length": 52,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Building a Language Model Application: Chat Models\n",
    "type": "text",
    "translate": true,
    "length": 54,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Similarly, you can use chat models instead of LLMs. Chat models are a variation on language models. While chat models use language models under the hood, the interface they expose is a bit different: rather than expose a \"text in, text out\" API, they expose an interface where \"chat messages\" are the inputs and outputs.\n",
    "type": "text",
    "translate": true,
    "length": 321,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Chat model APIs are fairly new, so we are still figuring out the correct abstractions.\n",
    "type": "text",
    "translate": true,
    "length": 87,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Get Message Completions from a Chat Model\n",
    "type": "text",
    "translate": true,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "You can get chat completions by passing one or more messages to the chat model. The response will be a message. The types of messages currently supported in LangChain are `AIMessage`, `HumanMessage`, `SystemMessage`, and `ChatMessage` -- `ChatMessage` takes in an arbitrary role parameter. Most of the time, you'll just be dealing with `HumanMessage`, `AIMessage`, and `SystemMessage`.\n",
    "type": "text",
    "translate": true,
    "length": 386,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.chat_models import ChatOpenAI\n",
    "type": "code",
    "translate": false,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "from langchain.schema import (\n",
    "type": "code",
    "translate": false,
    "length": 31,
    "metadata": {}
  },
  {
    "text": "    AIMessage,\n",
    "type": "code",
    "translate": false,
    "length": 15,
    "metadata": {}
  },
  {
    "text": "    HumanMessage,\n",
    "type": "code",
    "translate": false,
    "length": 18,
    "metadata": {}
  },
  {
    "text": "    SystemMessage\n",
    "type": "code",
    "translate": false,
    "length": 18,
    "metadata": {}
  },
  {
    "text": ")\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "chat = ChatOpenAI(temperature=0)\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "You can get completions by passing in a single message.\n",
    "type": "text",
    "translate": true,
    "length": 56,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "chat([HumanMessage(content=\"Translate this sentence from English to French. I love programming.\")])\n",
    "type": "code",
    "translate": false,
    "length": 100,
    "metadata": {}
  },
  {
    "text": "# -> AIMessage(content=\"J'aime programmer.\", additional_kwargs={})\n",
    "type": "code",
    "translate": false,
    "length": 67,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "You can also pass in multiple messages for OpenAI's gpt-3.5-turbo and gpt-4 models.\n",
    "type": "text",
    "translate": true,
    "length": 84,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "messages = [\n",
    "type": "code",
    "translate": false,
    "length": 13,
    "metadata": {}
  },
  {
    "text": "    SystemMessage(content=\"You are a helpful assistant that translates English to French.\"),\n",
    "type": "code",
    "translate": false,
    "length": 93,
    "metadata": {}
  },
  {
    "text": "    HumanMessage(content=\"Translate this sentence from English to French. I love programming.\")\n",
    "type": "code",
    "translate": false,
    "length": 96,
    "metadata": {}
  },
  {
    "text": "]\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "chat(messages)\n",
    "type": "code",
    "translate": false,
    "length": 15,
    "metadata": {}
  },
  {
    "text": "# -> AIMessage(content=\"J'aime programmer.\", additional_kwargs={})\n",
    "type": "code",
    "translate": false,
    "length": 67,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "You can go one step further and generate completions for multiple sets of messages using `generate`. This returns an `LLMResult` with an additional `message` parameter:\n",
    "type": "text",
    "translate": true,
    "length": 169,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "batch_messages = [\n",
    "type": "code",
    "translate": false,
    "length": 19,
    "metadata": {}
  },
  {
    "text": "    [\n",
    "type": "code",
    "translate": false,
    "length": 6,
    "metadata": {}
  },
  {
    "text": "        SystemMessage(content=\"You are a helpful assistant that translates English to French.\"),\n",
    "type": "code",
    "translate": false,
    "length": 97,
    "metadata": {}
  },
  {
    "text": "        HumanMessage(content=\"Translate this sentence from English to French. I love programming.\")\n",
    "type": "code",
    "translate": false,
    "length": 100,
    "metadata": {}
  },
  {
    "text": "    ],\n",
    "type": "code",
    "translate": false,
    "length": 7,
    "metadata": {}
  },
  {
    "text": "    [\n",
    "type": "code",
    "translate": false,
    "length": 6,
    "metadata": {}
  },
  {
    "text": "        SystemMessage(content=\"You are a helpful assistant that translates English to French.\"),\n",
    "type": "code",
    "translate": false,
    "length": 97,
    "metadata": {}
  },
  {
    "text": "        HumanMessage(content=\"Translate this sentence from English to French. I love artificial intelligence.\")\n",
    "type": "code",
    "translate": false,
    "length": 112,
    "metadata": {}
  },
  {
    "text": "    ],\n",
    "type": "code",
    "translate": false,
    "length": 7,
    "metadata": {}
  },
  {
    "text": "]\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "result = chat.generate(batch_messages)\n",
    "type": "code",
    "translate": false,
    "length": 39,
    "metadata": {}
  },
  {
    "text": "result\n",
    "type": "code",
    "translate": false,
    "length": 7,
    "metadata": {}
  },
  {
    "text": "# -> LLMResult(generations=[[ChatGeneration(text=\"J'aime programmer.\", generation_info=None, message=AIMessage(content=\"J'aime programmer.\", additional_kwargs={}))], [ChatGeneration(text=\"J'aime l'intelligence artificielle.\", generation_info=None, message=AIMessage(content=\"J'aime l'intelligence artificielle.\", additional_kwargs={}))]], llm_output={'token_usage': {'prompt_tokens': 71, 'completion_tokens': 18, 'total_tokens': 89}})\n",
    "type": "code",
    "translate": false,
    "length": 435,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "You can recover things like token usage from this LLMResult:\n",
    "type": "text",
    "translate": true,
    "length": 61,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "result.llm_output['token_usage']\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "# -> {'prompt_tokens': 71, 'completion_tokens': 18, 'total_tokens': 89}\n",
    "type": "code",
    "translate": false,
    "length": 72,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Chat Prompt Templates\n",
    "type": "text",
    "translate": true,
    "length": 25,
    "metadata": {}
  },
  {
    "text": "Similar to LLMs, you can make use of templating by using a `MessagePromptTemplate`. You can build a `ChatPromptTemplate` from one or more `MessagePromptTemplate`s. You can use `ChatPromptTemplate`'s `format_prompt` -- this returns a `PromptValue`, which you can convert to a string or `Message` object, depending on whether you want to use the formatted value as input to an llm or chat model.\n",
    "type": "text",
    "translate": true,
    "length": 394,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "For convience, there is a `from_template` method exposed on the template. If you were to use this template, this is what it would look like:\n",
    "type": "text",
    "translate": true,
    "length": 141,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.chat_models import ChatOpenAI\n",
    "type": "code",
    "translate": false,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "from langchain.prompts.chat import (\n",
    "type": "code",
    "translate": false,
    "length": 37,
    "metadata": {}
  },
  {
    "text": "    ChatPromptTemplate,\n",
    "type": "code",
    "translate": false,
    "length": 24,
    "metadata": {}
  },
  {
    "text": "    SystemMessagePromptTemplate,\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "    HumanMessagePromptTemplate,\n",
    "type": "code",
    "translate": false,
    "length": 32,
    "metadata": {}
  },
  {
    "text": ")\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "chat = ChatOpenAI(temperature=0)\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "template=\"You are a helpful assistant that translates {input_language} to {output_language}.\"\n",
    "type": "code",
    "translate": false,
    "length": 94,
    "metadata": {}
  },
  {
    "text": "system_message_prompt = SystemMessagePromptTemplate.from_template(template)\n",
    "type": "code",
    "translate": false,
    "length": 76,
    "metadata": {}
  },
  {
    "text": "human_template=\"{text}\"\n",
    "type": "code",
    "translate": false,
    "length": 24,
    "metadata": {}
  },
  {
    "text": "human_message_prompt = HumanMessagePromptTemplate.from_template(human_template)\n",
    "type": "code",
    "translate": false,
    "length": 80,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "chat_prompt = ChatPromptTemplate.from_messages([system_message_prompt, human_message_prompt])\n",
    "type": "code",
    "translate": false,
    "length": 94,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# get a chat completion from the formatted messages\n",
    "type": "code",
    "translate": false,
    "length": 52,
    "metadata": {}
  },
  {
    "text": "chat(chat_prompt.format_prompt(input_language=\"English\", output_language=\"French\", text=\"I love programming.\").to_messages())\n",
    "type": "code",
    "translate": false,
    "length": 126,
    "metadata": {}
  },
  {
    "text": "# -> AIMessage(content=\"J'aime programmer.\", additional_kwargs={})\n",
    "type": "code",
    "translate": false,
    "length": 67,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Chains with Chat Models\n",
    "type": "text",
    "translate": true,
    "length": 27,
    "metadata": {}
  },
  {
    "text": "The `LLMChain` discussed in the above section can be used with chat models as well:\n",
    "type": "text",
    "translate": true,
    "length": 84,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.chat_models import ChatOpenAI\n",
    "type": "code",
    "translate": false,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "from langchain import LLMChain\n",
    "type": "code",
    "translate": false,
    "length": 31,
    "metadata": {}
  },
  {
    "text": "from langchain.prompts.chat import (\n",
    "type": "code",
    "translate": false,
    "length": 37,
    "metadata": {}
  },
  {
    "text": "    ChatPromptTemplate,\n",
    "type": "code",
    "translate": false,
    "length": 24,
    "metadata": {}
  },
  {
    "text": "    SystemMessagePromptTemplate,\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "    HumanMessagePromptTemplate,\n",
    "type": "code",
    "translate": false,
    "length": 32,
    "metadata": {}
  },
  {
    "text": ")\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "chat = ChatOpenAI(temperature=0)\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "template=\"You are a helpful assistant that translates {input_language} to {output_language}.\"\n",
    "type": "code",
    "translate": false,
    "length": 94,
    "metadata": {}
  },
  {
    "text": "system_message_prompt = SystemMessagePromptTemplate.from_template(template)\n",
    "type": "code",
    "translate": false,
    "length": 76,
    "metadata": {}
  },
  {
    "text": "human_template=\"{text}\"\n",
    "type": "code",
    "translate": false,
    "length": 24,
    "metadata": {}
  },
  {
    "text": "human_message_prompt = HumanMessagePromptTemplate.from_template(human_template)\n",
    "type": "code",
    "translate": false,
    "length": 80,
    "metadata": {}
  },
  {
    "text": "chat_prompt = ChatPromptTemplate.from_messages([system_message_prompt, human_message_prompt])\n",
    "type": "code",
    "translate": false,
    "length": 94,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "chain = LLMChain(llm=chat, prompt=chat_prompt)\n",
    "type": "code",
    "translate": false,
    "length": 47,
    "metadata": {}
  },
  {
    "text": "chain.run(input_language=\"English\", output_language=\"French\", text=\"I love programming.\")\n",
    "type": "code",
    "translate": false,
    "length": 90,
    "metadata": {}
  },
  {
    "text": "# -> \"J'aime programmer.\"\n",
    "type": "code",
    "translate": false,
    "length": 26,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "## Agents with Chat Models\n",
    "type": "text",
    "translate": true,
    "length": 27,
    "metadata": {}
  },
  {
    "text": "Agents can also be used with chat models, you can initialize one using `AgentType.CHAT_ZERO_SHOT_REACT_DESCRIPTION` as the agent type.\n",
    "type": "text",
    "translate": true,
    "length": 135,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.agents import load_tools\n",
    "type": "code",
    "translate": false,
    "length": 40,
    "metadata": {}
  },
  {
    "text": "from langchain.agents import initialize_agent\n",
    "type": "code",
    "translate": false,
    "length": 46,
    "metadata": {}
  },
  {
    "text": "from langchain.agents import AgentType\n",
    "type": "code",
    "translate": false,
    "length": 39,
    "metadata": {}
  },
  {
    "text": "from langchain.chat_models import ChatOpenAI\n",
    "type": "code",
    "translate": false,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "from langchain.llms import OpenAI\n",
    "type": "code",
    "translate": false,
    "length": 34,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# First, let's load the language model we're going to use to control the agent.\n",
    "type": "code",
    "translate": false,
    "length": 80,
    "metadata": {}
  },
  {
    "text": "chat = ChatOpenAI(temperature=0)\n",
    "type": "code",
    "translate": false,
    "length": 33,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# Next, let's load some tools to use. Note that the `llm-math` tool uses an LLM, so we need to pass that in.\n",
    "type": "code",
    "translate": false,
    "length": 109,
    "metadata": {}
  },
  {
    "text": "llm = OpenAI(temperature=0)\n",
    "type": "code",
    "translate": false,
    "length": 28,
    "metadata": {}
  },
  {
    "text": "tools = load_tools([\"serpapi\", \"llm-math\"], llm=llm)\n",
    "type": "code",
    "translate": false,
    "length": 53,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# Finally, let's initialize an agent with the tools, the language model, and the type of agent we want to use.\n",
    "type": "code",
    "translate": false,
    "length": 111,
    "metadata": {}
  },
  {
    "text": "agent = initialize_agent(tools, chat, agent=AgentType.CHAT_ZERO_SHOT_REACT_DESCRIPTION, verbose=True)\n",
    "type": "code",
    "translate": false,
    "length": 102,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "# Now let's test it out!\n",
    "type": "code",
    "translate": false,
    "length": 25,
    "metadata": {}
  },
  {
    "text": "agent.run(\"Who is Olivia Wilde's boyfriend? What is his current age raised to the 0.23 power?\")\n",
    "type": "code",
    "translate": false,
    "length": 96,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```pycon\n",
    "type": "code",
    "translate": false,
    "length": 9,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "> Entering new AgentExecutor chain...\n",
    "type": "code",
    "translate": false,
    "length": 38,
    "metadata": {}
  },
  {
    "text": "Thought: I need to use a search engine to find Olivia Wilde's boyfriend and a calculator to raise his age to the 0.23 power.\n",
    "type": "code",
    "translate": false,
    "length": 125,
    "metadata": {}
  },
  {
    "text": "Action:\n",
    "type": "code",
    "translate": false,
    "length": 8,
    "metadata": {}
  },
  {
    "text": "{\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "  \"action\": \"Search\",\n",
    "type": "code",
    "translate": false,
    "length": 22,
    "metadata": {}
  },
  {
    "text": "  \"action_input\": \"Olivia Wilde boyfriend\"\n",
    "type": "code",
    "translate": false,
    "length": 43,
    "metadata": {}
  },
  {
    "text": "}\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Observation: Sudeikis and Wilde's relationship ended in November 2020. Wilde was publicly served with court documents regarding child custody while she was presenting Don't Worry Darling at CinemaCon 2022. In January 2021, Wilde began dating singer Harry Styles after meeting during the filming of Don't Worry Darling.\n",
    "type": "code",
    "translate": false,
    "length": 319,
    "metadata": {}
  },
  {
    "text": "Thought:I need to use a search engine to find Harry Styles' current age.\n",
    "type": "code",
    "translate": false,
    "length": 73,
    "metadata": {}
  },
  {
    "text": "Action:\n",
    "type": "code",
    "translate": false,
    "length": 8,
    "metadata": {}
  },
  {
    "text": "{\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "  \"action\": \"Search\",\n",
    "type": "code",
    "translate": false,
    "length": 22,
    "metadata": {}
  },
  {
    "text": "  \"action_input\": \"Harry Styles age\"\n",
    "type": "code",
    "translate": false,
    "length": 37,
    "metadata": {}
  },
  {
    "text": "}\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Observation: 29 years\n",
    "type": "code",
    "translate": false,
    "length": 22,
    "metadata": {}
  },
  {
    "text": "Thought:Now I need to calculate 29 raised to the 0.23 power.\n",
    "type": "code",
    "translate": false,
    "length": 61,
    "metadata": {}
  },
  {
    "text": "Action:\n",
    "type": "code",
    "translate": false,
    "length": 8,
    "metadata": {}
  },
  {
    "text": "{\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "  \"action\": \"Calculator\",\n",
    "type": "code",
    "translate": false,
    "length": 26,
    "metadata": {}
  },
  {
    "text": "  \"action_input\": \"29^0.23\"\n",
    "type": "code",
    "translate": false,
    "length": 28,
    "metadata": {}
  },
  {
    "text": "}\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Observation: Answer: 2.169459462491557\n",
    "type": "code",
    "translate": false,
    "length": 39,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "Thought:I now know the final answer.\n",
    "type": "code",
    "translate": false,
    "length": 37,
    "metadata": {}
  },
  {
    "text": "Final Answer: 2.169459462491557\n",
    "type": "code",
    "translate": false,
    "length": 32,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "> Finished chain.\n",
    "type": "code",
    "translate": false,
    "length": 18,
    "metadata": {}
  },
  {
    "text": "'2.169459462491557'\n",
    "type": "code",
    "translate": false,
    "length": 20,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "## Memory: Add State to Chains and Agents\n",
    "type": "text",
    "translate": true,
    "length": 42,
    "metadata": {}
  },
  {
    "text": "You can use Memory with chains and agents initialized with chat models. The main difference between this and Memory for LLMs is that rather than trying to condense all previous messages into a string, we can keep them as their own unique memory object.\n",
    "type": "text",
    "translate": true,
    "length": 253,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "```python\n",
    "type": "code",
    "translate": false,
    "length": 10,
    "metadata": {}
  },
  {
    "text": "from langchain.prompts import (\n",
    "type": "code",
    "translate": false,
    "length": 32,
    "metadata": {}
  },
  {
    "text": "    ChatPromptTemplate, \n",
    "type": "code",
    "translate": false,
    "length": 25,
    "metadata": {}
  },
  {
    "text": "    MessagesPlaceholder, \n",
    "type": "code",
    "translate": false,
    "length": 26,
    "metadata": {}
  },
  {
    "text": "    SystemMessagePromptTemplate, \n",
    "type": "code",
    "translate": false,
    "length": 34,
    "metadata": {}
  },
  {
    "text": "    HumanMessagePromptTemplate\n",
    "type": "code",
    "translate": false,
    "length": 31,
    "metadata": {}
  },
  {
    "text": ")\n",
    "type": "code",
    "translate": false,
    "length": 2,
    "metadata": {}
  },
  {
    "text": "from langchain.chains import ConversationChain\n",
    "type": "code",
    "translate": false,
    "length": 47,
    "metadata": {}
  },
  {
    "text": "from langchain.chat_models import ChatOpenAI\n",
    "type": "code",
    "translate": false,
    "length": 45,
    "metadata": {}
  },
  {
    "text": "from langchain.memory import ConversationBufferMemory\n",
    "type": "code",
    "translate": false,
    "length": 54,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "prompt = ChatPromptTemplate.from_messages([\n",
    "type": "code",
    "translate": false,
    "length": 44,
    "metadata": {}
  },
  {
    "text": "    SystemMessagePromptTemplate.from_template(\"The following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.\"),\n",
    "type": "code",
    "translate": false,
    "length": 281,
    "metadata": {}
  },
  {
    "text": "    MessagesPlaceholder(variable_name=\"history\"),\n",
    "type": "code",
    "translate": false,
    "length": 50,
    "metadata": {}
  },
  {
    "text": "    HumanMessagePromptTemplate.from_template(\"{input}\")\n",
    "type": "code",
    "translate": false,
    "length": 56,
    "metadata": {}
  },
  {
    "text": "])\n",
    "type": "code",
    "translate": false,
    "length": 3,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "llm = ChatOpenAI(temperature=0)\n",
    "type": "code",
    "translate": false,
    "length": 32,
    "metadata": {}
  },
  {
    "text": "memory = ConversationBufferMemory(return_messages=True)\n",
    "type": "code",
    "translate": false,
    "length": 56,
    "metadata": {}
  },
  {
    "text": "conversation = ConversationChain(memory=memory, prompt=prompt, llm=llm)\n",
    "type": "code",
    "translate": false,
    "length": 72,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "conversation.predict(input=\"Hi there!\")\n",
    "type": "code",
    "translate": false,
    "length": 40,
    "metadata": {}
  },
  {
    "text": "# -> 'Hello! How can I assist you today?'\n",
    "type": "code",
    "translate": false,
    "length": 42,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "conversation.predict(input=\"I'm doing well! Just having a conversation with an AI.\")\n",
    "type": "code",
    "translate": false,
    "length": 85,
    "metadata": {}
  },
  {
    "text": "# -> \"That sounds like fun! I'm happy to chat with you. Is there anything specific you'd like to talk about?\"\n",
    "type": "code",
    "translate": false,
    "length": 110,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "code",
    "translate": false,
    "length": 1,
    "metadata": {}
  },
  {
    "text": "conversation.predict(input=\"Tell me about yourself.\")\n",
    "type": "code",
    "translate": false,
    "length": 54,
    "metadata": {}
  },
  {
    "text": "# -> \"Sure! I am an AI language model created by OpenAI. I was trained on a large dataset of text from the internet, which allows me to understand and generate human-like language. I can answer questions, provide information, and even have conversations like this one. Is there anything else you'd like to know about me?\"\n",
    "type": "code",
    "translate": false,
    "length": 322,
    "metadata": {}
  },
  {
    "text": "```\n",
    "type": "code",
    "translate": false,
    "length": 4,
    "metadata": {}
  },
  {
    "text": "\n",
    "type": "text",
    "translate": true,
    "length": 1,
    "metadata": {}
  }
]